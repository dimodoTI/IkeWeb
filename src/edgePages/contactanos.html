<!DOCTYPE html>
<html lang="en">

<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-172712176-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-172712176-1');
    </script>


    <title>IKE</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport"
        content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="stylesheet" type="text/css" href="edgeStyles.css">
</head>
<style>
    body {
        display: flex;
        background-image: url("../assets/images/formulario.jpg");
        background-size: cover;
        height: 100%;
        width: 100%;
        overflow: hidden;
    }
</style>

<body>




    <div class="contenedor">
        <div class="titulo" style="padding-top: 2rem;padding-bottom:1rem;font-size:3rem;font-weight: bold;">ENVIANOS<BR>
            TU CONSULTA
        </div>
        <div class="subcabecera" media-size="large">Por favor, completá tus datos con tus comentarios y te responderemos
            a la brevedad
        </div>
        <div>
            <div class="divTexto"><input type="text" id="nombre" class="texto" placeholder="Nombre" value=""></div>
            <div class="divTexto"><input type="text" id="mail" class="texto" placeholder="Email" value=""></div>
            <div class="divTexto"><input type="text" id="telefono" class="texto" placeholder="Telefono" value=""></div>
            <div class="divTexto"><textarea style="width:80%;" rows="5" id="comentario" type="text"
                    placeholder="Comentarios" value=""></textarea></div>
            <div class="botonenviar" id="boton" onclick="enviar()">ENVIAR</div>
        </div>

        <div class </div> </div> </div> <div class="logoBottom">
            <svg xmlns="https://www.w3.org/2000/svg" id="Capa_1" data-name="Capa 1" viewBox="0 0 2000 2000">
                <defs></defs>
                <path d="M711.76,1036.7l413.1-413.11h110L821.76,1036.7,1110.07,1357H996.85Z" />
                <path d="M591.54,1359V924.05H675.9V1359Z" />
                <path d="M344.63,1359V924.05H429V1359Z" />
                <path
                    d="M1655.37,1088.21c0-206.33-93.17-319.93-262.23-319.93-176.17,0-256.45,157.66-256.45,304.08,0,151.35,77.92,304.05,251.92,304.05,140,0,225-65.45,259.81-200.29l.95-3.36h-77.08l-.42,2.14c-17.12,78.84-83.64,133.87-161.72,133.87-120.1,0-190.73-79.47-194.21-217.92h439.43Zm-437.09-65c8.89-87,59.87-187.32,176-187.32,106.08,0,172.07,68.38,181.68,187.32Z" />
                <rect x="344.63" y="777.31" width="84.38" height="82.72" />
                <polygon points="1469.53 706.84 1551.78 623.87 1653.57 623.87 1571.35 706.84 1469.53 706.84" />
            </svg>
        </div>
    </div>

</body>
<script>
    function enviar(e) {


        let errores = validarCampos()

        if (!errores) {
            sendMail()
            location.href = "institucional.html"
        } else {

            alert("ERROR :\n\n" + errores.reduce((text, msg) => {
                return text + "• " + msg.campo + ": " + msg.mensaje + "\n"
            }, ""))

        }
    }

    function validarCampos() {
        const errores = []
        let nombre = document.getElementById("nombre").value
        let email = document.getElementById("mail").value
        let telefono = document.getElementById("telefono").value
        let comentario = document.getElementById("comentario").value

        if (nombre == "") {
            errores.push({
                campo: "Nombre",
                mensaje: "No puede ser Vacio"

            })
        }

        if (email == "" || !validaMail(email)) {
            errores.push({
                campo: "Mail",
                mensaje: "Mail Incorrecto"

            })
        }

        if (telefono == "") {
            errores.push({
                campo: "Telefono",
                mensaje: "No puede ser Vacio"

            })
        }

        return errores.length == 0 ? null : errores;

    }


    function validaMail(email) {
        var regex = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        return regex.test(email) ? true : false;
    }


    function sendMail(e) {


        let nombre = document.getElementById("nombre").value
        let email = document.getElementById("mail").value
        let telefono = document.getElementById("telefono").value
        let comentario = document.getElementById("comentario").value

        let cuerpo = {
            nombre: nombre,
            email: email,
            telefono: telefono,
            comentario: comentario
        }

        fetch("https://servicio-email.herokuapp.com/ike-mail", {
            method: "POST",
            mode: 'cors',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(cuerpo)
        }).then(
            (response) => {
                //console.log(response);
                alert("Su consulta ha sido enviada y será contactado por un operador IKE")
                let nombre = this.getElementById("nombre")
                let email = this.getElementById("mail")
                let telefono = this.getElementById("telefono")
                let comentario = this.getElementById("comentario")
                nombre.value = ""
                email.value = ""
                telefono.value = ""
                comentario.value = ""


            }
        ).catch((response) => {
            alert("Su email no pudo ser enviado, intente mas tarde")
            let nombre = this.getElementById("nombre")
            let email = this.getElementById("mail")
            let telefono = this.getElementById("telefono")
            let comentario = this.getElementById("comentario")
            nombre.value = ""
            email.value = ""
            telefono.value = ""
            comentario.value = ""


        });
    }
</script>


</html>